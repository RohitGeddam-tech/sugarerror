{"version":3,"sources":["pages/Patient/ReportBills/ReportBills.jsx"],"names":["ReportBills","profile","useContext","ProfileContext","useState","data","pagination","reportList","setReportList","per_page","current_page","sort","selectedDate","moment","subtract","format","date_from","date_to","filter","setFilter","loading","setLoading","start","end","setState","reportsColumnDefs","label","width","dateFilter","show","selectDateRange","accessKey","classes","isMobile","cellRenderer","referred_by","full_name","tests","map","test","ind","length","total_amount","rupeeSymbol","appointment_status","className","name","formatted_name","row","blue","link","to","pathname","state","reportId","uuid","disabled","view_report","isActionColumn","useEffect","window","scrollTo","getData","useCallback","a","url","selectedRole","item","key","value","join","fetchRequest","method","isAuth","res","status","json","meta","getListPerPage","pg","ranges","Today","toDate","Yesterday","startOf","endOf","id","initialSettings","maxDate","Date","startDate","endDate","autoUpdateInput","onCallback","_d","CalendarFilter","columnDefs","tableData","isButtonCard","NextArrow","MobileCardComponent","MobileCard","isLoading","listName"],"mappings":"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","file":"static/js/70.3bf394a1.chunk.js","sourcesContent":["import React, { useCallback, useContext, useEffect, useState } from 'react';\nimport { OutlinedButton } from '../../../components/Buttons/Button';\nimport { CalendarFilter } from '../../../assets/icons';\nimport Table from '../../../components/Table/Table';\nimport { ProfileContext } from '../../../context/context';\nimport { fetchRequest } from '../../../utils/api';\nimport { rupeeSymbol } from '../../../utils/constants';\nimport moment from 'moment';\nimport DateRangePicker from 'react-bootstrap-daterangepicker';\nimport 'bootstrap/dist/css/bootstrap.css';\nimport 'bootstrap-daterangepicker/daterangepicker.css';\nimport {  NextArrow } from '../../../assets/icons';\nimport MobileCard from '../MobileCard';\n\nconst ReportBills = () => {\n  /* eslint-disable no-unused-vars */\n  const { profile } = useContext(ProfileContext);\n  const [reportList, setReportList] = useState({ data: [], pagination: {} });\n  const [filter, setFilter] = useState({\n    per_page: 15,\n    current_page: 1,\n    sort: [],\n    selectedDate: moment().subtract(1, 'year').format('YYYY-MM-DD'),\n    date_from: moment().subtract(1, 'year').format('YYYY-MM-DD'),\n    date_to: moment().format('YYYY-MM-DD'),\n  });\n  const [loading, setLoading] = useState(false);\n  const [state, setState] = useState({ start: moment(), end: moment() });\n\n  const reportsColumnDefs = [\n    {\n      label: 'Date / Time',\n      width: '7%',\n      dateFilter: { show: true, selectDateRange: false },\n      accessKey: 'created_at',\n    },\n    {\n      label: 'Patient Name',\n      width: '12%',\n      accessKey: 'patient.full_name',\n      classes: 'main-content semi-bold',\n      isMobile : false\n    },\n    {\n      label: 'Lab Name',\n      width: '18%',\n      accessKey: 'lab.formatted_lab_name',\n    },\n    {\n      label: 'Referral',\n      width: '12%',\n      cellRenderer: ({ referred_by }) => referred_by?.full_name || 'Self',\n      isMobile : false\n    },\n    {\n      label: 'Tests',\n      width: '20%',\n      accessKey: 'package_name',\n      cellRenderer: ({ tests }) => tests.map((test, ind) => (ind === tests.length - 1 ? test : test + ', ')),\n    },\n    {\n      label: 'Cost',\n      width: '10%',\n      cellRenderer: ({ total_amount }) => `${rupeeSymbol} ${total_amount}`,\n      isMobile : false\n    },\n    {\n      label: 'Status',\n      width: '10%',\n      cellRenderer: ({ appointment_status }) => (\n        <OutlinedButton className={`patient-status-btn ${appointment_status.name}`}>{appointment_status.formatted_name}</OutlinedButton>\n      ),\n    },\n    {\n      label: 'Action',\n      width: '12%',\n      isMobile : false,\n      cellRenderer: row => {\n        return (\n          <div className=\"d-flex align-items-center\">\n            <OutlinedButton\n              blue\n              link\n              to={{\n                pathname: `/patient/view-report`,\n                state: { reportId: row.uuid },\n              }}\n              disabled={!row.view_report}\n            >\n              View Report\n            </OutlinedButton>\n          </div>\n        );\n      },\n      isActionColumn : true\n    },\n  ];\n\n  useEffect(() => {\n    window.scrollTo(0, 0);\n  }, []);\n  \n  const getData = useCallback(() => {\n    setLoading(true);\n    const { per_page = 15, current_page, date_from, date_to, sort } = filter;\n    if (per_page)\n      (async () => {\n        let url = `/patient/${profile.selectedRole.uuid}/reports${date_from ? `?date_from=${date_from}` : ''}${\n          date_to && date_to !== 'Invalid date' ? `&date_to=${date_to}` : ''\n        }&per_page=${per_page}${current_page ? `&page=${current_page}` : ''}${\n          sort && sort.length ? sort.map(item => `&${item.key}=${item.value}`).join('') : ''\n        }`;\n        const res = await fetchRequest({ url, method: 'GET', isAuth: true });\n        if (res && res.status === 200) {\n          setLoading(false);\n          const { data, meta } = await res.json();\n          setReportList({ data, pagination: meta.pagination });\n          return data;\n        } else {\n          setLoading(false);\n        }\n        return;\n      })();\n  }, [filter, profile]);\n\n  useEffect(() => {\n    const { date_from, date_to } = filter;\n    getData({ date_from, date_to });\n  }, [filter, getData]);\n\n  const getListPerPage = useCallback(pg => {\n    setFilter(filter => ({ ...filter, ...pg }));\n  }, []);\n\n  const handleCallback = (start, end) => {\n    setState({ start, end });\n    setFilter({\n      ...filter,\n      date_from: moment(start._d).format('YYYY-MM-DD'),\n      date_to: moment(end._d).format('YYYY-MM-DD'),\n      current_page: 1,\n    });\n  };\n\n  const label = filter.date_from && moment(filter.date_from).format('DD-MM-YYYY') + ' to ' + moment(filter.date_to).format('DD-MM-YYYY');\n\n  const ranges = {\n    Today: [moment().toDate(), moment().toDate()],\n    Yesterday: [moment().subtract(1, 'days').toDate(), moment().subtract(1, 'days').toDate()],\n    'This Month': [moment().startOf('month').toDate(), moment().endOf('month').toDate()],\n    'Last 7 Days': [moment().subtract(6, 'days').toDate(), moment().toDate()],\n    'Last 30 Days': [moment().subtract(29, 'days').toDate(), moment().toDate()],\n    'Last 6 Months': [moment().subtract(6, 'months').toDate(), moment().toDate()],\n    'Last 1 Year': [moment().subtract(1, 'year').toDate(), moment().toDate()],\n  };\n\n  return (\n    <div className=\"paper card list-container report-bills-container\">\n      <div className=\"content-header\">\n        <div className=\"row\">\n          <div className=\"col-6 col-md-9\">\n            <p className=\"semi-bold title\">All Reports</p>\n          </div>\n          <div className=\"col-md-3 col-12 customDatePicker-wrapper\">\n            <DateRangePicker\n              className=\"customDatePicker\"\n              id=\"customDatePicker\"\n              initialSettings={{\n                maxDate: new Date(),\n                startDate: moment().subtract(1, 'year').toDate(),\n                endDate: moment().toDate(),\n                ranges: ranges,\n                autoUpdateInput: true,\n              }}\n              onCallback={handleCallback}\n            >\n              <div className=\"customDatePicker-innerwrapper\">\n                <span className={label ? 'range-value' : 'range-placeholder'}>{label ? label : 'Select Range'}</span>\n                <label className=\"table-icon d-inline\">{CalendarFilter}</label>\n              </div>\n            </DateRangePicker>\n          </div>\n        </div>\n      </div>\n      <div className=\"content-body\">\n        <Table\n          columnDefs={reportsColumnDefs}\n          tableData={reportList.data}\n          pagination={{ ...reportList.pagination, getListPerPage }}\n          isButtonCard={<span>{NextArrow}</span>}\n          MobileCardComponent={MobileCard}\n          setFilter={setFilter}\n          filter={filter}\n          isLoading={loading}\n          listName=\"reports\"\n        ></Table>\n      </div>\n    </div>\n  );\n};\n\nexport default ReportBills;\n"],"sourceRoot":""}